<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="语言无关性 # graph LR A(*.java)-->D(.class) B(*.rb)-->D C(*.groovy)-->D E(其它JVM语言)-->D D-->F(JVM) 文件结构 # u1 = 1byte
类型 名称 数量 u4 magic 1 u2 minor_version 1 u2 major_version 1 u2 constant_pool_count 1 cp_info constant_pool constant_pool_count-1 u2 access_flags 1 u2 this_class 1 u2 super_class 1 u2 interfaces_count 1 u2 interfaces interfaces_count u2 fields_count 1 field_info fields fields_count u2 methods_count 1 method_info methods methods_count u2 attribute_count 1 attribute_info attributes attributes_count magic u4 # 0xCAFEEBABE constant_pool_count u2 # 常量池中, 常量的个数"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="/posts/java/java_class_file_analysis/"><meta property="og:title" content="Java Class文件结构"><meta property="og:description" content="语言无关性 # graph LR A(*.java)-->D(.class) B(*.rb)-->D C(*.groovy)-->D E(其它JVM语言)-->D D-->F(JVM) 文件结构 # u1 = 1byte 类型 名称 数量 u4 magic 1 u2 minor_version 1 u2 major_version 1 u2 constant_pool_count 1 cp_info constant_pool constant_pool_count-1 u2 access_flags 1 u2 this_class 1 u2 super_class 1 u2 interfaces_count 1 u2 interfaces interfaces_count u2 fields_count 1 field_info fields fields_count u2 methods_count 1 method_info methods methods_count u2 attribute_count 1 attribute_info attributes attributes_count magic u4 # 0xCAFEEBABE constant_pool_count u2 # 常量池中, 常量的个数"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-08-01T00:59:28+00:00"><meta property="article:modified_time" content="2019-08-01T00:59:28+00:00"><meta property="article:tag" content="JVM"><meta property="article:tag" content="Java"><meta property="article:tag" content="Class文件"><title>Java Class文件结构 | </title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=/posts/java/java_class_file_analysis/><link rel=stylesheet href=/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css><script defer src=/fuse.min.js></script><script defer src=/en.search.min.8aa13e2f4b9fdd1fa1c269db82d4ba6bb2746e64391b4052adb11ab4309caef3.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span></span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Java Class文件结构</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#语言无关性>语言无关性</a></li><li><a href=#文件结构>文件结构</a></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h1><a href=/posts/java/java_class_file_analysis/>Java Class文件结构</a></h1><h5>August 1, 2019</h5><div><a href=/tags/jvm/>JVM</a>,
<a href=/tags/java/>Java</a>,
<a href=/tags/class%E6%96%87%E4%BB%B6/>Class文件</a></div><h3 id=语言无关性>语言无关性
<a class=anchor href=#%e8%af%ad%e8%a8%80%e6%97%a0%e5%85%b3%e6%80%a7>#</a></h3><script src=/mermaid.min.js></script><script>mermaid.initialize({flowchart:{useMaxWidth:!0},theme:"default"})</script><p class=mermaid>graph LR
A(*.java)-->D(.class)
B(*.rb)-->D
C(*.groovy)-->D
E(其它JVM语言)-->D
D-->F(JVM)</p><h3 id=文件结构>文件结构
<a class=anchor href=#%e6%96%87%e4%bb%b6%e7%bb%93%e6%9e%84>#</a></h3><p>u1 = 1byte</p><table><thead><tr><th>类型</th><th>名称</th><th>数量</th></tr></thead><tbody><tr><td>u4</td><td>magic</td><td>1</td></tr><tr><td>u2</td><td>minor_version</td><td>1</td></tr><tr><td>u2</td><td>major_version</td><td>1</td></tr><tr><td>u2</td><td>constant_pool_count</td><td>1</td></tr><tr><td>cp_info</td><td>constant_pool</td><td>constant_pool_count-1</td></tr><tr><td>u2</td><td>access_flags</td><td>1</td></tr><tr><td>u2</td><td>this_class</td><td>1</td></tr><tr><td>u2</td><td>super_class</td><td>1</td></tr><tr><td>u2</td><td>interfaces_count</td><td>1</td></tr><tr><td>u2</td><td>interfaces</td><td>interfaces_count</td></tr><tr><td>u2</td><td>fields_count</td><td>1</td></tr><tr><td>field_info</td><td>fields</td><td>fields_count</td></tr><tr><td>u2</td><td>methods_count</td><td>1</td></tr><tr><td>method_info</td><td>methods</td><td>methods_count</td></tr><tr><td>u2</td><td>attribute_count</td><td>1</td></tr><tr><td>attribute_info</td><td>attributes</td><td>attributes_count</td></tr></tbody></table><h4 id=magic-u4>magic u4
<a class=anchor href=#magic-u4>#</a></h4><ul><li>0xCAFEEBABE</li></ul><h4 id=constant_pool_count-u2>constant_pool_count u2
<a class=anchor href=#constant_pool_count-u2>#</a></h4><p>常量池中, 常量的个数</p><h4 id=constant_pool-cp_info>constant_pool cp_info
<a class=anchor href=#constant_pool-cp_info>#</a></h4><ul><li>CONSTANT_Utf8 1 UTF-8编码的Unicode字符串</li><li>CONSTANT_Integer 3 int类型的字面值</li><li>CONSTANT_Float 4 float类型的字面值</li><li>CONSTANT_Long 5 long类型的字面值</li><li>CONSTANT_Double 6 double类型的字面值</li><li>CONSTANT_Class 7 对一个类或接口的符号引用</li><li>CONSTANT_String 8 String类型字面值的引用</li><li>CONSTANT_Fieldref 9 对一个字段的符号引用</li><li>CONSTANT_Methodref 10 对一个类中方法的符号引用</li><li>CONSTANT_InterfaceMethodref 11 对一个接口中方法的符号引用</li><li>CONSTANT_NameAndType 12 对一个字段或方法的部分符号引用</li></ul><h4 id=access-flag-u2-类的标示符>access flag u2: 类的标示符
<a class=anchor href=#access-flag-u2-%e7%b1%bb%e7%9a%84%e6%a0%87%e7%a4%ba%e7%ac%a6>#</a></h4><table><thead><tr><th>flag name</th><th>value</th><th>interpretation</th></tr></thead><tbody><tr><td>ACC_PUBLIC</td><td>0x0001</td><td>public</td></tr><tr><td>ACC_FINAL</td><td>0x0010</td><td>final,不能被继承</td></tr><tr><td>ACC_SUPER</td><td>0x0020</td><td>是否允许使用invokespecial指令,jdk1.2后,该值为true</td></tr><tr><td>ACC_INTERFACE</td><td>0x0200</td><td>是否是接口</td></tr><tr><td>ACC_ABSTRACT</td><td>0x0400</td><td>抽象类</td></tr><tr><td>ACC_SYNTHETIC</td><td>0x1000</td><td>该类不是由用户代码生成,运行时生成的,没有源码</td></tr><tr><td>ACC_ANNOTATION</td><td>0x2000</td><td>是否为注解</td></tr><tr><td>ACC_ENUM</td><td>0x4000</td><td>是否为枚举</td></tr></tbody></table><h4 id=this_class-u2>this_class u2
<a class=anchor href=#this_class-u2>#</a></h4><ul><li>指向常量池的Class</li></ul><h4 id=super_class-u2>super_class u2
<a class=anchor href=#super_class-u2>#</a></h4><ul><li>指向常量池的Class</li></ul><h4 id=interface_count-u2>interface_count u2
<a class=anchor href=#interface_count-u2>#</a></h4><ul><li>接口数量</li></ul><h4 id=interfaces>interfaces
<a class=anchor href=#interfaces>#</a></h4><ul><li>interfaces_count 个interface u2</li><li>每个interface是指向CONSTANT_Class的索引</li></ul><h4 id=field_count>field_count
<a class=anchor href=#field_count>#</a></h4><ul><li>字段数量</li></ul><h4 id=fields>fields
<a class=anchor href=#fields>#</a></h4><ul><li>field_count个field_info</li></ul><h4 id=field>field
<a class=anchor href=#field>#</a></h4><ul><li>access_flags u2</li><li>name_index u2</li><li>descriptor_index u2</li><li>attributes_count u2</li><li>attribute_info attributes[attributes_count];</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#语言无关性>语言无关性</a></li><li><a href=#文件结构>文件结构</a></li></ul></li></ul></nav></div></aside></main></body></html>